(()=>{const e=document.baseURI||location.href,t=(t="")=>new URL(String(t),e).toString(),a=document.querySelector("[data-home-news]"),n=document.querySelector("[data-home-news-meta]"),r=Array.from(document.querySelectorAll("[data-home-stat]")),s=(e,t)=>{for(const a of r)a.getAttribute("data-home-stat")===e&&(a.textContent=String(t))},i=(e="")=>String(e).replaceAll("&","&amp;").replaceAll("<","&lt;").replaceAll(">","&gt;").replaceAll('"',"&quot;").replaceAll("'","&#39;"),o=(e,{featured:a=!1}={})=>{const n=t(`berita/${i(e.slug)}/`),r=((e="")=>{const a=String(e||"").trim();return a?a.startsWith("http://")||a.startsWith("https://")||a.startsWith("data:")?a:a.startsWith("/")?t(a.slice(1)):t(a.replace(/^\.+\//,"")):t("assets/img/og-default.png")})(e.image),s=[];e.location&&s.push(e.location),e.date_display&&s.push(e.date_display);const o=s.join(" • ");return`\n      <a class="${a?"news-card is-featured":"news-card"}" href="${n}">\n        <div class="news-thumb">\n          <img src="${i(r)}" alt="${i(e.title)}" loading="lazy" decoding="async" width="1200" height="675">\n        </div>\n        <div class="news-body">\n          <p class="news-title">${i(e.title)}</p>\n          ${e.excerpt?`<p class="news-snippet">${i(e.excerpt)}</p>`:""}\n          ${o?`<div class="news-meta">${i(o)}</div>`:""}\n        </div>\n      </a>\n    `};if(a){const e=3;a.innerHTML=Array.from({length:e}).map(()=>'\n        <div class="news-card" aria-hidden="true">\n          <div class="news-thumb" style="background: var(--bg-soft);"></div>\n          <div class="news-body">\n            <p class="news-title" style="background: var(--bg-soft); height: 14px; border-radius: 8px; margin-bottom: 10px;"></p>\n            <p class="news-snippet" style="background: var(--bg-soft); height: 12px; border-radius: 8px;"></p>\n            <div class="news-meta" style="background: var(--bg-soft); height: 10px; border-radius: 8px; width: 40%;"></div>\n          </div>\n        </div>\n      ').join("")}s("berita","—"),s("kelembagaan","—"),s("profil","—"),s("dokumen","—");const l=e=>fetch(e,{cache:"no-store"}).then(t=>t.ok?t.json():Promise.reject(new Error("Gagal memuat "+e))),d=t("berita/news-index.json"),c=t("assets/data/pages-index.json");Promise.all([l(d).catch(()=>null),l(c).catch(()=>null)]).then(([e,t])=>{e?(e=>{if(!a)return;const t=(Array.isArray(e)?e:[]).filter(e=>e&&"object"==typeof e&&e.slug&&e.title).map(e=>({...e,_dateMs:e.date_iso?Date.parse(String(e.date_iso)+"T00:00:00Z"):0,_pop:Number(e.popular_score||0)||0}));t.sort((e,t)=>t._dateMs-e._dateMs||t._pop-e._pop);const r=t.slice(0,3);if(!r.length)return a.innerHTML='<p class="news-snippet">Berita belum tersedia.</p>',n&&(n.textContent="Belum ada pembaruan."),void s("berita",0);if(a.innerHTML=r.map((e,t)=>o(e,{featured:0===t})).join(""),n){const e=r[0],a=t.length,s=e&&e._dateMs?new Date(e._dateMs):null,i=s?new Intl.DateTimeFormat("id-ID",{day:"2-digit",month:"long",year:"numeric"}).format(s):e.date_display||"—";n.textContent=`Terakhir diperbarui: ${i} • Total publikasi: ${a} berita`}s("berita",t.length)})(e):(a&&(a.innerHTML='<p class="news-snippet">Berita belum tersedia.</p>'),n&&(n.textContent="Gagal memuat pembaruan."),s("berita",0)),t?(e=>{const t=(Array.isArray(e)?e:[]).reduce((e,t)=>{const a=t&&t.category?String(t.category):"";return a?(e[a]=(e[a]||0)+1,e):e},{});s("kelembagaan",t.Kelembagaan||0),s("profil",t.Profil||0),s("dokumen",t.Dokumen||0)})(t):(s("kelembagaan",0),s("profil",0),s("dokumen",0))}).catch(()=>{a&&(a.innerHTML='<p class="news-snippet">Berita belum tersedia.</p>'),n&&(n.textContent="Gagal memuat pembaruan."),s("berita",0),s("kelembagaan",0),s("profil",0),s("dokumen",0)})})();